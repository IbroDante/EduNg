{% extends 'layout.html' %} {% block head %}
<title>EduNg | Dashboard</title>
{% endblock %} {% block body %}
<body>
  <br />
  <br />
  <br />
  <div class="container">
    <h1>Welcome, {{ user.username }}!</h1>
    <h2>Your Form Submissions</h2>
    <!-- ... (previous code) ... -->
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>User Name</th>
          <th>Email</th>
          <th>Phone Number</th>
          <th>Select Course</th>
          <th>Select course Time</th>
          <th>Actions</th>
          <!-- Add a new column for actions -->
        </tr>
      </thead>
      <tbody>
        {% for user_form in user_forms %}
        <!-- Use a different variable name here -->
        <tr>
          <td>{{ user_form.name }}</td>
          <td>{{ user.username }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user_form.phonenumber }}</td>
          <td>{{ user_form.selectcourse }}</td>
          <td>{{ user_form.selectcoursetime }}</td>
          <td>
            <!-- Edit Form Button -->
            <a
              href="{{ url_for('edit_form', form_id=user_form.id) }}"
              class="btn btn-primary"
              >Edit</a
            >

            <!-- Delete Form Button (with a confirmation dialog) -->

            <button
              class="btn btn-danger"
              onclick="deleteForm({{ user_form.id }})"
            >
              Delete
            </button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <!-- ... (remaining code) ... -->
  </div>
</body>
{% endblock %}

<script>
  function deleteForm(formId) {
    if (confirm("Are you sure you want to delete this form?")) {
      // Send an AJAX request to delete the form by formId
      fetch(`/delete_form/${formId}`, {
        method: "DELETE",
        headers: {
          "X-CSRFToken": "{{ csrf_token() }}", // Add CSRF token if using Flask-WTF
        },
      })
        .then((response) => {
          if (response.ok) {
            // Reload the page after successful deletion
            location.reload();
          } else {
            alert("Failed to delete the form.");
          }
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    }
  }
</script>
